# Excel数据模板说明

## 📋 模板文件列表

请按照以下格式准备Excel文件，放在 `data/` 目录下：

### 1. 订单数据.xlsx

**必需字段**：

| 列名 | 说明 | 示例 | 数据类型 |
|------|------|------|---------|
| 日期 | 订单日期 | 2025-11-03 | 日期 |
| 订单号 | 订单编号 | SO20251103001 | 文本 |
| 客户名称 | 客户公司名 | 上海华东石化 | 文本 |
| 金额 | 订单金额 | 85600 | 数字 |
| 状态 | 订单状态 | completed | 文本 |

**状态字段说明**：
- `completed` 或 `已完成` - 已完成订单
- `processing` 或 `处理中` - 处理中订单
- `pending` 或 `待处理` - 待处理订单
- `cancelled` 或 `已取消` - 已取消订单

**示例数据**：
```
日期         | 订单号          | 客户名称        | 金额    | 状态
2025-11-01  | SO20251101001  | 上海华东石化     | 85600  | completed
2025-11-01  | SO20251101002  | 江苏长江电力     | 65800  | processing
2025-11-02  | SO20251102001  | 浙江能源集团     | 92300  | completed
```

---

### 2. 生产数据.xlsx

**必需字段**：

| 列名 | 说明 | 示例 | 数据类型 |
|------|------|------|---------|
| 日期 | 生产日期 | 2025-11-03 | 日期 |
| 生产线 | 生产线名称 | 闸阀生产线 | 文本 |
| 产量 | 日产量 | 120 | 数字 |
| 合格率 | 合格率% | 96.5 | 数字 |
| 不良率 | 不良率% | 3.5 | 数字 |

**生产线名称建议**：
- 闸阀生产线
- 球阀生产线
- 蝶阀生产线
- 截止阀生产线
- 止回阀生产线

**示例数据**：
```
日期         | 生产线       | 产量 | 合格率 | 不良率
2025-11-03  | 闸阀生产线    | 120  | 96.5  | 3.5
2025-11-03  | 球阀生产线    | 98   | 94.2  | 5.8
2025-11-03  | 蝶阀生产线    | 115  | 97.1  | 2.9
```

---

### 3. 客户数据.xlsx

**必需字段**：

| 列名 | 说明 | 示例 | 数据类型 |
|------|------|------|---------|
| 客户名称 | 公司名 | 上海华东石化 | 文本 |
| 累计金额 | 累计订单金额 | 1250000 | 数字 |
| 等级 | 客户等级 | VIP | 文本 |
| 联系人 | 联系人姓名 | 张经理 | 文本 |
| 订单数 | 累计订单数 | 45 | 数字 |

**客户等级说明**：
- `VIP` - 顶级客户（年采购额>100万）
- `A` - A级客户（年采购额50-100万）
- `B` - B级客户（年采购额10-50万）
- `C` - C级客户（年采购额<10万）

**示例数据**：
```
客户名称        | 累计金额  | 等级 | 联系人  | 订单数
上海华东石化    | 1250000  | VIP | 张经理  | 45
江苏长江电力    | 980000   | A   | 李总    | 38
浙江能源集团    | 850000   | A   | 王主任  | 32
```

---

### 4. 质检数据.xlsx

**必需字段**：

| 列名 | 说明 | 示例 | 数据类型 |
|------|------|------|---------|
| 日期 | 检验日期 | 2025-11-03 | 日期 |
| 产品编号 | 产品编号 | V20251103001 | 文本 |
| 是否合格 | 合格状态 | 是 | 文本 |
| 检验员 | 检验员姓名 | 李师傅 | 文本 |
| 不良类型 | 不合格原因 | 尺寸偏差 | 文本 |

**是否合格字段说明**：
- `是` 或 `合格` 或 `1` 或 `true` - 合格
- `否` 或 `不合格` 或 `0` 或 `false` - 不合格

**示例数据**：
```
日期         | 产品编号      | 是否合格 | 检验员  | 不良类型
2025-11-03  | V20251103001 | 是      | 李师傅  | -
2025-11-03  | V20251103002 | 是      | 李师傅  | -
2025-11-03  | V20251103003 | 否      | 张师傅  | 尺寸偏差
```

---

## 📝 注意事项

### 1. 文件命名
- 必须使用上述**准确的文件名**
- 文件必须放在 `data/` 目录下
- 文件格式必须是 `.xlsx` (Excel 2007+)

### 2. 数据格式
- ✅ 日期格式：`YYYY-MM-DD` 或 Excel日期格式
- ✅ 数字不要带单位（如：写 `1250000` 不要写 `125万`）
- ✅ 状态使用英文或中文都可以
- ✅ 第一行必须是表头
- ✅ 不要有合并单元格

### 3. 数据质量
- 避免空行空列
- 数字字段不要有文字
- 日期格式保持统一
- 必填字段不要留空

### 4. 数据更新频率建议
```
订单数据   - 每天更新一次（下班前）
生产数据   - 每班更新一次（早班、中班、晚班）
客户数据   - 每周更新一次
质检数据   - 每天更新一次（下班前）
```

---

## 🔧 使用步骤

### 第一次使用：

1. **准备Excel文件**
   ```
   data/
   ├── 订单数据.xlsx  ← 按模板填写
   ├── 生产数据.xlsx  ← 按模板填写
   ├── 客户数据.xlsx  ← 按模板填写
   └── 质检数据.xlsx  ← 按模板填写
   ```

2. **运行导入脚本**
   ```bash
   npm install xlsx  # 首次需要安装依赖
   node scripts/import-excel.js
   ```

3. **查看生成结果**
   ```
   生成文件：public/data/realtime-data.json
   前端会自动读取这个文件
   ```

### 日常更新：

1. 更新Excel数据（员工填写）
2. 运行导入脚本（双击运行或定时任务）
3. 刷新浏览器查看大屏

---

## 🎯 快速开始示例

### 示例1：只有订单数据
如果暂时只想显示订单数据：
1. 只准备 `订单数据.xlsx`
2. 其他文件可以暂时不提供
3. 系统会使用默认数据填充其他模块

### 示例2：从现有系统导出
如果已有ERP/MES系统：
1. 从系统导出Excel报表
2. 调整列名匹配模板
3. 保存为对应文件名
4. 运行导入脚本

### 示例3：分步骤实施
第一周：只更新订单和客户数据
第二周：添加生产数据
第三周：添加质检数据
逐步完善，不求一步到位！

---

## 💡 常见问题

### Q: 列名必须完全一致吗？
A: 是的，列名需要严格匹配。或者可以修改 `scripts/import-excel.js` 脚本来适配你的列名。

### Q: 可以添加更多列吗？
A: 可以，脚本只会读取需要的列，其他列会被忽略。

### Q: 数据太多会影响性能吗？
A: 建议每个文件数据不超过10000行。如果数据量大，只导入最近一段时间的数据即可。

### Q: Excel放在网络共享盘可以吗？
A: 可以，修改 `scripts/import-excel.js` 中的路径指向网络盘即可。

### Q: 能否直接读取ERP系统的Excel导出？
A: 可以！调整脚本中的字段映射关系即可适配不同的列名。

---

## 📞 技术支持

如需帮助，请查看：
- [完整数据接入指南](../DATA_INTEGRATION_GUIDE.md)
- [项目README](../README.md)
- 或联系技术支持团队

---

**开始使用吧！** 🚀

